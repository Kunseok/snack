
<html>
	<center>
		<br>
	<div>
		<strong>	Goal : Execute alert(document.domain)
	</div><br>
	<div id=result></div>
	<br>
	<textarea id=ta></textarea> <!-- This TextArea is not a part of challenge. It's here just to help you quickly see the filtered output. -->
	<script>
				payload=location.hash.substr(1)
				payload=decodeURI(payload)
				if(payload.length==0 )
					payload="alt=hackMe"
				else
					payload=xssFilter(payload)
				result.innerHTML="<img src=x "+payload+">"
				ta.innerText=payload

			// filtered
			function xssFilter(p){
					// asci characters except () = and .
					p=p.replace(/[\x00-\x27\x2a-\x2d\x2f-\x3c\x3e-\x40\x5b-\x60\x7b-\x7f]+/g,"")
					p=p.replace(/[\u2028\u2029]+/g,"")


					// enforce single equals
					// enfore parenthesis limit
					try{
						if((p.match(/=/g).length)>1 || p.match(/[()]/g).length>2)
						p=":("
					}catch{}

					// filter on......=........ (... means alphanumeric and underscore)
					p=p.replace(/(on\w+)=(\w+)/ig,"")
					console.log(p)
					return p
			}

	</script>
<br><Br>
<!--Solvers : <br>
1. Gallus<br>
2. 1lastBr3ath<br>
3. Chilliesssssss<Br>-->
</html>

